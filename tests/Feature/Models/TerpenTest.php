<?php

use AmaizingCompany\CannaleoClient\Models\Terpen;
use Illuminate\Database\Eloquent\Relations\BelongsToMany;

// Base Model Tests
test('terpen model can be initiated', function () {
    $terpen = new Terpen;

    expect($terpen)
        ->toBeInstanceOf(Terpen::class)
        ->toBeObject();
});

test('terpen has correct guarded attributes', function () {
    $terpen = new Terpen;

    expect($terpen->getGuarded())->toBe([]);
});

// Model Configuration Tests
test('terpen has correct table name', function () {
    $terpen = new Terpen;

    expect($terpen->getTable())
        ->toBe('cannaleo_terpenes');
});

// Relationship Tests
test('products() returns a BelongsToMany relationship', function () {
    $terpen = new Terpen;

    expect($terpen->products())
        ->toBeInstanceOf(BelongsToMany::class);
});

test('products relationship can be loaded', function () {
    $terpen = Terpen::factory()->create();

    expect($terpen->products)
        ->toBeCollection();
});

// Attribute Type Tests
test('terpen attributes have correct types', function () {
    $terpen = Terpen::factory()->create();

    expect($terpen)
        ->id->toBeString()
        ->name->toBeString()
        ->created_at->toBeInstanceOf(\Illuminate\Support\Carbon::class)
        ->updated_at->toBeInstanceOf(\Illuminate\Support\Carbon::class);
});

test('terpen contract can be resolved to model class', function () {
    $terpen = app(\AmaizingCompany\CannaleoClient\Contracts\Models\Terpen::class);

    expect($terpen)
        ->toBeInstanceOf(Terpen::class);
});
